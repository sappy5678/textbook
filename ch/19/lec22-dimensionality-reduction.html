
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lec 22: Dimensionality Reduction &#8212; Principles and Techniques of Data Science</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  
  <h1 class="site-logo" id="site-title">Principles and Techniques of Data Science</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Frontmatter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../prereqs.html">
   Prerequisites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notation.html">
   Notation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../01/lifecycle_intro.html">
   1. The Data Science Lifecycle
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../01/lifecycle_students_1.html">
     1.1. The Students of Data 100
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/lifecycle_students_2.html">
     1.2. Exploratory Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/lifecycle_students_3.html">
     1.3. What’s in a Name?
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02/design_intro.html">
   2. Data Design
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../02/design_dewey_truman.html">
     2.1. Dewey Defeats Truman
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/design_prob_overview.html">
     2.2. Probability Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/design_sampling.html">
     2.3. Probability Sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/design_srs_vs_big_data.html">
     2.4. SRS vs. “Big Data”
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../03/pandas_intro.html">
   3. Working with Tabular Data
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../03/pandas_structure.html">
     3.1. Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/pandas_indexes.html">
     3.2. Indexes, Slicing, and Sorting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/pandas_grouping_pivoting.html">
     3.3. Grouping and Pivoting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/pandas_apply_strings_plotting.html">
     3.4. Apply, Strings, and Plotting
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../04/eda_intro.html">
   4. Exploratory Data Analysis
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../04/eda_data_types.html">
     4.1. Data Types
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../05/cleaning_intro.html">
   5. Data Cleaning
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../05/cleaning_calls.html">
     5.1. Cleaning the Calls Dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/cleaning_stops.html">
     5.2. Cleaning The Stops Dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/cleaning_structure.html">
     5.3. Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/cleaning_granularity.html">
     5.4. Granularity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/cleaning_scope.html">
     5.5. Scope
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/cleaning_temp.html">
     5.6. Temporality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/cleaning_faithfulness.html">
     5.7. Faithfulness
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../06/viz_intro.html">
   6. Data Visualization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz_quantitative.html">
     6.1. Visualizing Quantitative Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz_qualitative.html">
     6.2. Visualizing Qualitative Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz_matplotlib.html">
     6.3. Customizing Plots using
     <code class="docutils literal notranslate">
      <span class="pre">
       matplotlib
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz_principles.html">
     6.4. Visualization Principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz_principles_2.html">
     6.5. Visualization Principles Continued
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/viz_philosophy.html">
     6.6. Philosophy for Data Visualization
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../07/web_intro.html">
   7. Web Technologies
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../07/web_http.html">
     7.1. HTTP
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../08/text_intro.html">
   8. Working with Text
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../08/text_strings.html">
     8.1. Python String Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08/text_regex.html">
     8.2. Regular Expressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08/text_re.html">
     8.3. Regex and Python
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../09/sql_intro.html">
   9. Relational Databases and SQL
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../09/sql_rdbms.html">
     9.1. The Relational Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09/sql_basics.html">
     9.2. SQL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09/sql_joins.html">
     9.3. SQL Joins
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../10/modeling_intro.html">
   10. Modeling and Estimation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../10/modeling_simple.html">
     10.1. Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/modeling_loss_functions.html">
     10.2. Loss Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/modeling_abs_huber.html">
     10.3. Absolute and Huber Loss
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../11/gradient_descent.html">
   11. Gradient Descent and Numerical Optimization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../11/gradient_basics.html">
     11.1. Loss Minimization Using a Program
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/gradient_descent_define.html">
     11.2. Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/gradient_convexity.html">
     11.3. Convexity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/gradient_stochastic.html">
     11.4. Stochastic Gradient Descent
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../12/prob_and_gen.html">
   12. Probability and Generalization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../12/prob_random_vars.html">
     12.1. Random Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/prob_exp_var.html">
     12.2. Expectation and Variance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/prob_risk.html">
     12.3. Risk
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../13/linear_models.html">
   13. Linear Models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../13/linear_tips.html">
     13.1. Predicting Tip Amounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13/linear_grad.html">
     13.2. Fitting a Linear Model Using Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13/linear_multiple.html">
     13.3. Multiple Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13/linear_projection.html">
     13.4. Least Squares — A Geometric Perspective
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13/linear_case_study.html">
     13.5. Linear Regression Case Study
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../14/feature_engineering.html">
   14. Feature Engineering
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../14/feature_one_hot.html">
     14.1. The Walmart dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../14/feature_polynomial.html">
     14.2. Predicting Ice Cream Ratings
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../15/bias_intro.html">
   15. The Bias-Variance Tradeoff
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../15/bias_risk.html">
     15.1. Risk and Loss Minimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15/bias_modeling.html">
     15.2. Model Bias and Variance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15/bias_cv.html">
     15.3. Cross-Validation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../16/reg_intro.html">
   16. Regularization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../16/reg_intuition.html">
     16.1. Regularization Intuition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16/reg_ridge.html">
     16.2. L2 Regularization: Ridge Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16/reg_lasso.html">
     16.3. L1 Regularization: Lasso Regression
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../17/classification_intro.html">
   17. Classification
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../17/classification_prob.html">
     17.1. Regression on Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17/classification_log_model.html">
     17.2. The Logistic Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17/classification_cost.html">
     17.3. A Loss Function for the Logistic Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17/classification_log_reg.html">
     17.4. Using Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17/classification_cost_justification.html">
     17.5. Approximating the Empirical Probability Distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17/classification_sgd.html">
     17.6. Fitting a Logistic Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17/classification_sensitivity_specificity.html">
     17.7. Evaluating Logistic Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17/classification_multiclass.html">
     17.8. Multiclass Classification
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../18/hyp_intro.html">
   18. Statistical Inference
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../18/hyp_introduction.html">
     18.1. Hypothesis Testing and Confidence Intervals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18/hyp_introduction_part2.html">
     18.2. Permutation Test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18/hyp_regression.html">
     18.3. Bootstrapping for Linear Regression (Inference for the True Coefficients)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18/hyp_studentized.html">
     18.4. The Studentized Bootstrap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18/hyp_phacking.html">
     18.5. P-hacking
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pca_intro.html">
   19. Dimensionality Reduction and PCA
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="pca_dims.html">
     19.1. Dimensions of a Data Table
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pca_svd.html">
     19.2. PCA using the Singular Value Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pca_in_practice.html">
     19.3. PCA in Practice
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../20/vector_space_review.html">
   Vector Space Review
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../21/ref_intro.html">
   Reference Tables
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../21/ref_pandas.html">
     pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../21/ref_seaborn.html">
     Seaborn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../21/ref_matplotlib.html">
     matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../21/ref_sklearn.html">
     scikit-learn
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../22/contributors.html">
   Contributors
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/ch/19/lec22-dimensionality-reduction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/ch/19/lec22-dimensionality-reduction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#house-of-representatives-voting-data">
   House of Representatives Voting Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrix-operations-in-python">
   Matrix Operations in Python
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#singular-value-decomposition-experiment">
   Singular Value Decomposition Experiment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manual-decomposition">
     Manual Decomposition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#singular-value-decomposition-example">
     Singular Value Decomposition Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Singular Value Decomposition Experiment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-singular-values-matrix-sigma">
     The Singular Values Matrix
     <span class="math notranslate nohighlight">
      \(\Sigma\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-and-v-t">
     <span class="math notranslate nohighlight">
      \(U\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(V^T\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#low-rank-approximations-of-rectangle-data">
   Low Rank Approximations of Rectangle Data
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lec-22-dimensionality-reduction">
<h1>Lec 22: Dimensionality Reduction<a class="headerlink" href="#lec-22-dimensionality-reduction" title="Permalink to this headline">¶</a></h1>
<p><strong>by Josh Hug (Fall 2019)</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lec 20: Decision Trees</span>

<span class="o">**</span><span class="n">by</span> <span class="n">Josh</span> <span class="n">Hug</span> <span class="p">(</span><span class="n">Fall</span> <span class="mi">2019</span><span class="p">)</span><span class="o">**</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>We often create visualizations in order to facilitate exploratory data analysis. For example, we might create scatterplots to explore the relationship between pairs of variables in a dataset. Below, we see weight vs. height.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;hongkong_height_weight.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Height</th>
      <th>Weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65.78331</td>
      <td>112.9925</td>
    </tr>
    <tr>
      <th>1</th>
      <td>71.51521</td>
      <td>136.4873</td>
    </tr>
    <tr>
      <th>2</th>
      <td>69.39874</td>
      <td>153.0269</td>
    </tr>
    <tr>
      <th>3</th>
      <td>68.21660</td>
      <td>142.3354</td>
    </tr>
    <tr>
      <th>4</th>
      <td>67.78781</td>
      <td>144.2971</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Height&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Weight&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_4_0.png" src="../../_images/lec22-dimensionality-reduction_4_0.png" />
</div>
</div>
<p>The dataset below gives the “percentage body fat, age, weight, height, and ten body circumference measurements” for 252 men.</p>
<p>http://jse.amstat.org/v4n1/datasets.johnson.html</p>
<p>For simplicity, we read in only 8 of the provided attributes, yielding the given dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#http://jse.amstat.org/datasets/fat.txt</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="s2">&quot;fat.dat.txt&quot;</span><span class="p">,</span> <span class="n">colspecs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span> <span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span>
                                             <span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">53</span><span class="p">),</span> <span class="p">(</span><span class="mi">73</span><span class="p">,</span> <span class="mi">77</span><span class="p">),</span>
                                            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">85</span><span class="p">),</span> <span class="p">(</span><span class="mi">88</span><span class="p">,</span> <span class="mi">93</span><span class="p">)],</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">% f</span><span class="s2">at&quot;</span><span class="p">,</span> <span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;neck&quot;</span><span class="p">,</span> <span class="s2">&quot;chest&quot;</span><span class="p">,</span> <span class="s2">&quot;abdomen&quot;</span><span class="p">])</span>
<span class="n">df3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>% fat</th>
      <th>density</th>
      <th>age</th>
      <th>weight</th>
      <th>height</th>
      <th>neck</th>
      <th>chest</th>
      <th>abdomen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12.3</td>
      <td>1.0708</td>
      <td>23</td>
      <td>154.25</td>
      <td>67.75</td>
      <td>36.2</td>
      <td>93.1</td>
      <td>85.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.1</td>
      <td>1.0853</td>
      <td>22</td>
      <td>173.25</td>
      <td>72.25</td>
      <td>38.5</td>
      <td>93.6</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>25.3</td>
      <td>1.0414</td>
      <td>22</td>
      <td>154.00</td>
      <td>66.25</td>
      <td>34.0</td>
      <td>95.8</td>
      <td>87.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.4</td>
      <td>1.0751</td>
      <td>26</td>
      <td>184.75</td>
      <td>72.25</td>
      <td>37.4</td>
      <td>101.8</td>
      <td>86.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28.7</td>
      <td>1.0340</td>
      <td>24</td>
      <td>184.25</td>
      <td>71.25</td>
      <td>34.4</td>
      <td>97.3</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We see that percentage fat and density in g/cm^3 are almost completely redundant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df3</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% f</span><span class="s2">at&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;density&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_8_0.png" src="../../_images/lec22-dimensionality-reduction_8_0.png" />
</div>
</div>
<p>By contrast, while there is a strong correlation between neck and chest measurements, the resulting data is very 2 dimensional.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df3</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;neck&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;chest&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_10_0.png" src="../../_images/lec22-dimensionality-reduction_10_0.png" />
</div>
</div>
<p>Age and height show a small correlation as peolpe seem to get slightly smaller with greater age in this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df3</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;height&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_12_0.png" src="../../_images/lec22-dimensionality-reduction_12_0.png" />
</div>
</div>
<p>We note that there is one outlier where a person is slightly less than 29.5 inches tall. While there are a extraordinarily small number of adult males who are less than three feet tall, reflection on the rest of the data from this observation suggest that this was simply an error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;height &lt; 40&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>% fat</th>
      <th>density</th>
      <th>age</th>
      <th>weight</th>
      <th>height</th>
      <th>neck</th>
      <th>chest</th>
      <th>abdomen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>41</th>
      <td>32.9</td>
      <td>1.025</td>
      <td>44</td>
      <td>205.0</td>
      <td>29.5</td>
      <td>36.6</td>
      <td>106.0</td>
      <td>104.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df3</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;height&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_16_0.png" src="../../_images/lec22-dimensionality-reduction_16_0.png" />
</div>
</div>
<p>We can try to visualize more than 2 attributes at once, but the relationships displayed in e.g. the color and dot size space are much harder for human readers to see. For example, above we saw that density and % fat are almost entirely redundant, but this relationship is impossible to see when comparing the colors and dot sizes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df3</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;neck&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;chest&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% f</span><span class="s2">at&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_18_0.png" src="../../_images/lec22-dimensionality-reduction_18_0.png" />
</div>
</div>
<p>Seaborn gives us the ability to create a matrix of all possible pairs of variables. This is can be useful, though even with only 8 variables it’s still difficult to fully digest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_20_0.png" src="../../_images/lec22-dimensionality-reduction_20_0.png" />
</div>
</div>
<p>We should note that despite the very strong relationship between % fat and density, the numerical rank of the data matrix is still 8. For the rank to be 7, we’d need the data to be almost exactly on a line. We’ll talk about techniques to reduce the dimensionality over the course of this lecture and the next.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
</div>
</div>
<div class="section" id="house-of-representatives-voting-data">
<h2>House of Representatives Voting Data<a class="headerlink" href="#house-of-representatives-voting-data" title="Permalink to this headline">¶</a></h2>
<p>Next, let’s consider voting data from the house of representatives in the U.S. during the month of September 2019. In this example, our goal will be to try to find clusters of representatives who vote in similar ways. For example, we might expect to find that Democrats and Republicans vote similarly to other members of their party.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">ds100_utils</span> <span class="kn">import</span> <span class="n">fetch_and_cache</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="kn">import</span> <span class="nn">yaml</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/unitedstates/congress-legislators/raw/master/&#39;</span>
<span class="n">legislators_path</span> <span class="o">=</span> <span class="s1">&#39;legislators-current.yaml&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">fetch_and_cache</span><span class="p">(</span><span class="n">base_url</span> <span class="o">+</span> <span class="n">legislators_path</span><span class="p">,</span> <span class="n">legislators_path</span><span class="p">)</span>
<span class="n">legislators_data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">to_date</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">legs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;leg_id&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;chamber&#39;</span><span class="p">,</span> <span class="s1">&#39;party&#39;</span><span class="p">,</span> <span class="s1">&#39;birthday&#39;</span><span class="p">],</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">][</span><span class="s1">&#39;bioguide&#39;</span><span class="p">],</span> 
           <span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="s1">&#39;first&#39;</span><span class="p">],</span>
           <span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="s1">&#39;last&#39;</span><span class="p">],</span>
           <span class="n">x</span><span class="p">[</span><span class="s1">&#39;bio&#39;</span><span class="p">][</span><span class="s1">&#39;gender&#39;</span><span class="p">],</span>
           <span class="n">x</span><span class="p">[</span><span class="s1">&#39;terms&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;state&#39;</span><span class="p">],</span>
           <span class="n">x</span><span class="p">[</span><span class="s1">&#39;terms&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
           <span class="n">x</span><span class="p">[</span><span class="s1">&#39;terms&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">],</span>
           <span class="n">to_date</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;bio&#39;</span><span class="p">][</span><span class="s1">&#39;birthday&#39;</span><span class="p">])]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">legislators_data</span><span class="p">])</span>

<span class="n">legs</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading... Done!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/srv/conda/envs/data100/lib/python3.7/site-packages/ipykernel_launcher.py:4: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  after removing the cwd from sys.path.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>leg_id</th>
      <th>first</th>
      <th>last</th>
      <th>gender</th>
      <th>state</th>
      <th>chamber</th>
      <th>party</th>
      <th>birthday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B000944</td>
      <td>Sherrod</td>
      <td>Brown</td>
      <td>M</td>
      <td>OH</td>
      <td>sen</td>
      <td>Democrat</td>
      <td>1952-11-09</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C000127</td>
      <td>Maria</td>
      <td>Cantwell</td>
      <td>F</td>
      <td>WA</td>
      <td>sen</td>
      <td>Democrat</td>
      <td>1958-10-13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C000141</td>
      <td>Benjamin</td>
      <td>Cardin</td>
      <td>M</td>
      <td>MD</td>
      <td>sen</td>
      <td>Democrat</td>
      <td>1943-10-05</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># February 2019 House of Representatives roll call votes</span>
<span class="c1"># Downloaded using https://github.com/eyeseast/propublica-congress</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;votes.csv&#39;</span><span class="p">)</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">votes</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s2">&quot;roll call&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span> 
<span class="n">votes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chamber</th>
      <th>session</th>
      <th>roll call</th>
      <th>member</th>
      <th>vote</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>House</td>
      <td>1</td>
      <td>555</td>
      <td>A000374</td>
      <td>Not Voting</td>
    </tr>
    <tr>
      <th>1</th>
      <td>House</td>
      <td>1</td>
      <td>555</td>
      <td>A000370</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>2</th>
      <td>House</td>
      <td>1</td>
      <td>555</td>
      <td>A000055</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>House</td>
      <td>1</td>
      <td>555</td>
      <td>A000371</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>House</td>
      <td>1</td>
      <td>555</td>
      <td>A000372</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">votes</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">legs</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;member&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;leg_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chamber_x</th>
      <th>session</th>
      <th>roll call</th>
      <th>member</th>
      <th>vote</th>
      <th>leg_id</th>
      <th>first</th>
      <th>last</th>
      <th>gender</th>
      <th>state</th>
      <th>chamber_y</th>
      <th>party</th>
      <th>birthday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4112</th>
      <td>House</td>
      <td>1</td>
      <td>526</td>
      <td>D000617</td>
      <td>No</td>
      <td>D000617</td>
      <td>Suzan</td>
      <td>DelBene</td>
      <td>F</td>
      <td>WA</td>
      <td>rep</td>
      <td>Democrat</td>
      <td>1962-02-17</td>
    </tr>
    <tr>
      <th>9599</th>
      <td>House</td>
      <td>1</td>
      <td>533</td>
      <td>L000576</td>
      <td>No</td>
      <td>L000576</td>
      <td>Billy</td>
      <td>Long</td>
      <td>M</td>
      <td>MO</td>
      <td>rep</td>
      <td>Republican</td>
      <td>1955-08-11</td>
    </tr>
    <tr>
      <th>1060</th>
      <td>House</td>
      <td>1</td>
      <td>520</td>
      <td>B000490</td>
      <td>No</td>
      <td>B000490</td>
      <td>Sanford</td>
      <td>Bishop</td>
      <td>M</td>
      <td>GA</td>
      <td>rep</td>
      <td>Democrat</td>
      <td>1947-02-04</td>
    </tr>
    <tr>
      <th>9</th>
      <td>House</td>
      <td>1</td>
      <td>546</td>
      <td>A000374</td>
      <td>Not Voting</td>
      <td>A000374</td>
      <td>Ralph</td>
      <td>Abraham</td>
      <td>M</td>
      <td>LA</td>
      <td>rep</td>
      <td>Republican</td>
      <td>1954-09-16</td>
    </tr>
    <tr>
      <th>16427</th>
      <td>House</td>
      <td>1</td>
      <td>535</td>
      <td>W000819</td>
      <td>Yes</td>
      <td>W000819</td>
      <td>Mark</td>
      <td>Walker</td>
      <td>M</td>
      <td>NC</td>
      <td>rep</td>
      <td>Republican</td>
      <td>1969-05-20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">was_yes</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vote_pivot</span> <span class="o">=</span> <span class="n">votes</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;member&#39;</span><span class="p">,</span> 
                                <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;roll call&#39;</span><span class="p">,</span> 
                                <span class="n">values</span><span class="o">=</span><span class="s1">&#39;vote&#39;</span><span class="p">,</span> 
                                <span class="n">aggfunc</span><span class="o">=</span><span class="n">was_yes</span><span class="p">,</span> 
                                <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vote_pivot</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vote_pivot</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(441, 41)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>roll call</th>
      <th>515</th>
      <th>516</th>
      <th>517</th>
      <th>518</th>
      <th>519</th>
      <th>520</th>
      <th>521</th>
      <th>522</th>
      <th>523</th>
      <th>524</th>
      <th>...</th>
      <th>546</th>
      <th>547</th>
      <th>548</th>
      <th>549</th>
      <th>550</th>
      <th>551</th>
      <th>552</th>
      <th>553</th>
      <th>554</th>
      <th>555</th>
    </tr>
    <tr>
      <th>member</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A000055</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A000367</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>A000369</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A000370</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>A000371</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 41 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vote_pivot</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(441, 41)
</pre></div>
</div>
</div>
</div>
<p>This data has 441 observations (members of the House of Representatives including the 6 non-voting representatives) and 41 dimensions (votes). While politics is quite polarized, none of these columns are linearly dependent as we note below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">vote_pivot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>41
</pre></div>
</div>
</div>
</div>
<p>Suppose we want to find clusters of similar voting behavior. We might try by reducing our data to only two dimensions and looking to see if we can identify clear patterns. Let’s start by looking at what votes were most controversial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">vote_pivot</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>roll call
555    0.249988
540    0.249896
530    0.249896
537    0.249783
542    0.249783
533    0.249711
534    0.249711
536    0.249711
543    0.249711
550    0.249628
552    0.249536
549    0.249536
546    0.249536
518    0.249433
517    0.249320
547    0.249320
545    0.249063
553    0.248765
525    0.248425
551    0.248240
531    0.247397
524    0.246389
526    0.246111
521    0.246111
529    0.244898
528    0.244230
527    0.243150
520    0.242378
523    0.241144
522    0.231796
539    0.231796
516    0.221461
538    0.216679
544    0.198066
515    0.112546
541    0.095218
554    0.078743
532    0.071153
535    0.051460
519    0.047398
548    0.043295
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We see that roll call 548 had very little variance. According to <a class="reference external" href="http://clerk.house.gov/evs/2019/roll548.xml">http://clerk.house.gov/evs/2019/roll548.xml</a>, this bill was referring to the 2019 Whistleblower Complaint about President Trump and Ukraine. The full text of the house resolution for this roll call can be found at <a class="reference external" href="https://www.congress.gov/bill/116th-congress/house-resolution/576/text">https://www.congress.gov/bill/116th-congress/house-resolution/576/text</a>:</p>
<p>(1) the whistleblower complaint received on August 12, 2019, by the Inspector General of the Intelligence Community shall be transmitted immediately to the Select Committee on Intelligence of the Senate and the Permanent Select Committee on Intelligence of the House of Representatives; and</p>
<p>(2) the Select Committee on Intelligence of the Senate and the Permanent Select Committee on Intelligence of the House of Representatives should be allowed to evaluate the complaint in a deliberate and bipartisan manner consistent with applicable statutes and processes in order to safeguard classified and sensitive information.</p>
<p>We see that 421 congresspeople voted for this resolution, and 12 did not vote for this resolution. 2 members answered “present” but did not vote no, and 10 did not vote at all. Clearly, a scatterplot involving this particular dimension isn’t going to be useful.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vote_pivot</span><span class="p">[</span><span class="s1">&#39;548&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    421
0     20
Name: 548, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>By contrast, we saw high variance for most of the other roll call votes. Most them had variances near 0.25, which is the maximum possible for a variable which can take on values 0 or 1. Let’s consider the two highest variance variables, shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vote_pivot</span><span class="p">[</span><span class="s1">&#39;555&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    222
0    219
Name: 555, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vote_pivot</span><span class="p">[</span><span class="s1">&#39;530&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    225
0    216
Name: 530, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Let’s use these as our two dimensions for our scatterplot and see what happens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;530&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;555&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">vote_pivot</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_43_0.png" src="../../_images/lec22-dimensionality-reduction_43_0.png" />
</div>
</div>
<p>By adding some random noise, we can get rid of the overplotting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vote_pivot_jittered</span> <span class="o">=</span> <span class="n">vote_pivot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">vote_pivot_jittered</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;515&#39;</span><span class="p">:</span><span class="s1">&#39;555&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">vote_pivot_jittered</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;515&#39;</span><span class="p">:</span><span class="s1">&#39;555&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;530&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;555&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">vote_pivot_jittered</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_46_0.png" src="../../_images/lec22-dimensionality-reduction_46_0.png" />
</div>
</div>
<p>We can also look at this data labeled by party.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vote_pivot_labeled</span> <span class="o">=</span> <span class="n">vote_pivot</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">legs</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;member&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;leg_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;member&#39;</span><span class="p">)</span>
<span class="n">vote_pivot_labeled</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>515</th>
      <th>516</th>
      <th>517</th>
      <th>518</th>
      <th>519</th>
      <th>520</th>
      <th>521</th>
      <th>522</th>
      <th>523</th>
      <th>524</th>
      <th>...</th>
      <th>554</th>
      <th>555</th>
      <th>leg_id</th>
      <th>first</th>
      <th>last</th>
      <th>gender</th>
      <th>state</th>
      <th>chamber</th>
      <th>party</th>
      <th>birthday</th>
    </tr>
    <tr>
      <th>member</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A000055</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>A000055</td>
      <td>Robert</td>
      <td>Aderholt</td>
      <td>M</td>
      <td>AL</td>
      <td>rep</td>
      <td>Republican</td>
      <td>1965-07-22</td>
    </tr>
    <tr>
      <th>A000367</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>A000367</td>
      <td>Justin</td>
      <td>Amash</td>
      <td>M</td>
      <td>MI</td>
      <td>rep</td>
      <td>Libertarian</td>
      <td>1980-04-18</td>
    </tr>
    <tr>
      <th>A000369</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>A000369</td>
      <td>Mark</td>
      <td>Amodei</td>
      <td>M</td>
      <td>NV</td>
      <td>rep</td>
      <td>Republican</td>
      <td>1958-06-12</td>
    </tr>
    <tr>
      <th>A000370</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>A000370</td>
      <td>Alma</td>
      <td>Adams</td>
      <td>F</td>
      <td>NC</td>
      <td>rep</td>
      <td>Democrat</td>
      <td>1946-05-27</td>
    </tr>
    <tr>
      <th>A000371</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>A000371</td>
      <td>Pete</td>
      <td>Aguilar</td>
      <td>M</td>
      <td>CA</td>
      <td>rep</td>
      <td>Democrat</td>
      <td>1979-06-19</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 49 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vote_pivot_labeled_jittered</span> <span class="o">=</span> <span class="n">vote_pivot_labeled</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">vote_pivot_labeled_jittered</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;515&#39;</span><span class="p">:</span><span class="s1">&#39;555&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">vote_pivot_labeled_jittered</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;515&#39;</span><span class="p">:</span><span class="s1">&#39;555&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;530&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;555&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">vote_pivot_labeled_jittered</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;party&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_50_0.png" src="../../_images/lec22-dimensionality-reduction_50_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;545&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;552&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">vote_pivot_labeled_jittered</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;party&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lec22-dimensionality-reduction_51_0.png" src="../../_images/lec22-dimensionality-reduction_51_0.png" />
</div>
</div>
<p>We see that considering only two votes does seem to do a pretty good job of telling Republicans from Democrats. We’ll see in the next lecture how we can do even better using a technique called “Principle Component Analysis” or PCA.</p>
<p>Before we can get there, we’ll need to spend some time reviewing key linear algebra principles.</p>
</div>
<div class="section" id="matrix-operations-in-python">
<h2>Matrix Operations in Python<a class="headerlink" href="#matrix-operations-in-python" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_and_height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">182</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span> <span class="p">[</span><span class="mi">399</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">725</span><span class="p">,</span> <span class="mi">33</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_and_height</span> <span class="o">@</span> <span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[182.        ,  28.        ,   2.33333333],
       [399.        ,  30.        ,   2.5       ],
       [725.        ,  33.        ,   2.75      ]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="singular-value-decomposition-experiment">
<h2>Singular Value Decomposition Experiment<a class="headerlink" href="#singular-value-decomposition-experiment" title="Permalink to this headline">¶</a></h2>
<div class="section" id="manual-decomposition">
<h3>Manual Decomposition<a class="headerlink" href="#manual-decomposition" title="Permalink to this headline">¶</a></h3>
<p>In the table below, we have the width, height, area, and perimeter of a rectangle stored in a dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rectangle</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;rectangle_data.csv&quot;</span><span class="p">)</span>
<span class="n">rectangle</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>6</td>
      <td>48</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>3</td>
      <td>27</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>8</td>
      <td>72</td>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Naturally the perimeter is just the sum of 2x the width and 2x the height. Thus, if we create a new dataframe that has only the width, height, and area…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rectangle_no_perim</span> <span class="o">=</span> <span class="n">rectangle</span><span class="p">[[</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">]]</span>
<span class="n">rectangle_no_perim</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>6</td>
      <td>48</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>4</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>3</td>
      <td>27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>8</td>
      <td>72</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>… then we can recover the perimeter by multiplying this matrix by</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span>&#160;&#160; <span class="pre">0</span>&#160;&#160; <span class="pre">0</span>&#160;&#160; <span class="pre">2</span> <span class="pre">0</span>&#160;&#160; <span class="pre">1</span>&#160;&#160; <span class="pre">0</span>&#160;&#160; <span class="pre">2</span> <span class="pre">0</span>&#160;&#160; <span class="pre">0</span>&#160;&#160; <span class="pre">1</span>&#160;&#160; <span class="pre">0</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transform_3D_to_4D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rectangle_with_perimeter_back</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rectangle_no_perim</span><span class="p">)</span> <span class="o">@</span> <span class="n">transform_3D_to_4D</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rectangle_with_perimeter_back</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="s2">&quot;perimeter&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>6</td>
      <td>48</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>3</td>
      <td>27</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>8</td>
      <td>72</td>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="singular-value-decomposition-example">
<h3>Singular Value Decomposition Example<a class="headerlink" href="#singular-value-decomposition-example" title="Permalink to this headline">¶</a></h3>
<p>Singular value decomposition is a numerical technique to (among other things) automatically uncover such redundancies. Given an input matrix X, SVD will return <span class="math notranslate nohighlight">\(U\Sigma\)</span> and <span class="math notranslate nohighlight">\(V^T\)</span> such that <span class="math notranslate nohighlight">\( X = U \Sigma V^T \)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">rectangle</span><span class="p">,</span> <span class="n">full_matrices</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As we did before with our manual decomposition, we can recover our original rectangle data by multiplying the three return values of this function back together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="n">s</span> <span class="o">@</span> <span class="n">vt</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.0</td>
      <td>6.0</td>
      <td>48.0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.0</td>
      <td>3.0</td>
      <td>27.0</td>
      <td>24.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The two key pieces of the decomposition are <span class="math notranslate nohighlight">\(U\Sigma\)</span> and <span class="math notranslate nohighlight">\(V^T\)</span>, which we can think of for now as analogous to our ‘data’ and ‘transformation operation’ from our manual decomposition earlier.</p>
<p>Let’s start by looking at <span class="math notranslate nohighlight">\(U\Sigma\)</span>, which we can compute with the Python code <code class="docutils literal notranslate"><span class="pre">u*s</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">*</span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
         1.83452516e-15],
       [-1.39258714e+01, -5.61592446e+00,  1.59106852e+00,
        -3.36581235e-15],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-3.68444316e+01, -4.80005945e+00, -3.80095908e+00,
        -2.03741937e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-7.42135662e+00, -5.11810904e+00, -1.31469604e+00,
         7.80250388e-17],
       [-1.39588585e+01, -5.62314077e+00, -1.23715703e+00,
         5.55717762e-17],
       [-3.79895573e+01, -1.31360807e+00, -2.60712770e-01,
         3.01043718e-16],
       [-1.56692269e+01, -9.65347804e+00, -4.03555325e+00,
         3.52041495e-16],
       [-2.54468092e+01, -7.81311695e+00, -3.92620778e+00,
        -8.48509568e-17],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-4.08780385e+01, -1.86471027e+00, -2.34708823e+00,
         5.13492882e-17],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-2.82033419e+01, -8.33535389e+00,  5.30031897e+00,
         4.89486243e-17],
       [-6.40083890e+01,  7.06150790e+00,  1.43570386e+00,
         1.74060388e-16],
       [-4.32916052e+01, -1.02057499e-01, -9.09120615e-01,
         1.11263532e-16],
       [-1.39258714e+01, -5.61592446e+00,  1.59106852e+00,
         1.29145985e-16],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-1.84343928e+01, -4.99433025e+00, -4.79403711e-01,
         7.25592757e-18],
       [-1.77311945e+01, -1.07873203e+01, -4.71576755e+00,
        -5.67149843e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-3.31624238e+01, -4.83891361e+00, -3.13664801e+00,
         7.19721747e-17],
       [-4.40851318e+01,  4.87898862e-01,  5.12943775e-01,
         3.02603255e-16],
       [-3.18939828e+01, -3.11511500e+00, -1.03436931e+00,
         2.99484180e-16],
       [-4.08780385e+01, -1.86471027e+00, -2.34708823e+00,
         5.13492882e-17],
       [-2.25748215e+01, -7.26562290e+00, -3.25394509e+00,
         1.87126013e-16],
       [-2.29099271e+01, -4.36551973e+00,  2.78349606e-01,
        -3.75451682e-19],
       [-9.48332419e+00, -6.25195129e+00, -1.99491034e+00,
        -2.74769124e-17],
       [-7.09469707e+01,  9.44214673e+00, -6.10913535e-01,
        -2.57057627e-16],
       [-1.39588585e+01, -5.62314077e+00, -1.23715703e+00,
         5.55717762e-17],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-1.77311945e+01, -1.07873203e+01, -4.71576755e+00,
        -5.67149843e-16],
       [-2.74019549e+01, -3.74031736e+00, -3.78009854e-01,
        -1.65127367e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-6.23718552e+01,  5.89241965e+00,  2.83391341e+00,
        -1.81938882e-17],
       [-2.94144418e+01, -4.86333514e+00,  3.18411417e+00,
         3.46804968e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-5.71027944e+01,  4.67365277e+00,  6.54095701e-01,
         1.76237992e-16],
       [-1.47523850e+01, -5.03318441e+00,  1.84907363e-01,
         1.84935901e-16],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-2.54468092e+01, -7.81311695e+00, -3.92620778e+00,
        -8.48509568e-17],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-1.56692269e+01, -9.65347804e+00, -4.03555325e+00,
         3.52041495e-16],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-2.20834134e+01, -4.94825977e+00,  1.68451077e+00,
         2.91846763e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-3.79730637e+01, -1.30999991e+00,  1.15340001e+00,
        -1.06495470e-16],
       [-1.97931620e+01, -1.19211625e+01, -5.39598185e+00,
         1.11621311e-16],
       [-2.57984083e+01, -4.91662193e+00, -1.80802586e+00,
         2.97924643e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-5.62762807e+01,  4.09091272e+00,  2.06025686e+00,
         1.42984452e-16],
       [-1.97931620e+01, -1.19211625e+01, -5.39598185e+00,
         1.11621311e-16],
       [-2.53478478e+01, -7.79146801e+00,  4.55846888e+00,
         1.95178398e-16],
       [-2.94144418e+01, -4.86333514e+00,  3.18411417e+00,
         3.46804968e-16],
       [-3.79895573e+01, -1.31360807e+00, -2.60712770e-01,
         3.01043718e-16],
       [-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
        -7.51795410e-17],
       [-2.83187968e+01, -8.36061099e+00, -4.59847046e+00,
         2.64707301e-16],
       [-3.67454702e+01, -4.77841051e+00,  4.68371758e+00,
         4.68711369e-17],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-9.43384352e+00, -6.24112682e+00,  2.24742798e+00,
         1.12537765e-16],
       [-1.47523850e+01, -5.03318441e+00,  1.84907363e-01,
         1.84935901e-16],
       [-2.82033419e+01, -8.33535389e+00,  5.30031897e+00,
         4.89486243e-17],
       [-3.18939828e+01, -3.11511500e+00, -1.03436931e+00,
         2.99484180e-16],
       [-1.68308462e+01, -6.17063481e+00, -1.90941971e+00,
        -1.42390326e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-5.01807063e+01,  2.28940579e+00,  1.28660032e+00,
         3.04162792e-16],
       [-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
        -7.51795410e-17],
       [-2.24923537e+01, -7.24758212e+00,  3.81661879e+00,
         3.41408172e-16],
       [-3.18609957e+01, -3.10789868e+00,  1.79385624e+00,
        -1.45045689e-16],
       [-3.29742148e+00, -2.85042454e+00,  4.57325598e-02,
         1.11175616e-17],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-3.67454702e+01, -4.77841051e+00,  4.68371758e+00,
         4.68711369e-17],
       [-2.53478478e+01, -7.79146801e+00,  4.55846888e+00,
         1.95178398e-16],
       [-8.21488316e+00, -4.52815268e+00,  1.07368347e-01,
         1.47608402e-17],
       [-3.31624238e+01, -4.83891361e+00, -3.13664801e+00,
         7.19721747e-17],
       [-1.76157396e+01, -1.07620632e+01,  5.18302188e+00,
         1.93518744e-16],
       [-1.15452918e+01, -7.38579354e+00, -2.67512465e+00,
        -2.95716741e-16],
       [-4.32586181e+01, -9.48411854e-02,  1.91910494e+00,
        -2.63936669e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-7.42135662e+00, -5.11810904e+00, -1.31469604e+00,
         7.80250388e-17],
       [-7.09469707e+01,  9.44214673e+00, -6.10913535e-01,
        -2.57057627e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-2.73854614e+01, -3.73670921e+00,  1.03610292e+00,
        -1.54079509e-16],
       [-2.73854614e+01, -3.73670921e+00,  1.03610292e+00,
        -1.54079509e-16],
       [-1.14793175e+01, -7.37136091e+00,  2.98132646e+00,
        -2.99548674e-17],
       [-4.40851318e+01,  4.87898862e-01,  5.12943775e-01,
         3.02603255e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-6.40248825e+01,  7.05789975e+00,  2.15910829e-02,
         3.36050508e-17],
       [-9.43384352e+00, -6.24112682e+00,  2.24742798e+00,
         1.12537765e-16],
       [-1.35247915e+01, -8.50159500e+00,  3.71522493e+00,
        -1.72447500e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16]])
</pre></div>
</div>
</div>
</div>
<p>Similarly, we can look at vt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.46435746e-01, -1.29942186e-01, -8.10020095e-01,
        -5.52755864e-01],
       [-1.92735898e-01, -1.89127741e-01,  5.86348204e-01,
        -7.63727278e-01],
       [-7.04957447e-01,  7.09155330e-01,  7.95161387e-03,
         8.39576575e-03],
       [-6.66666667e-01, -6.66666667e-01, -1.08794322e-16,
         3.33333333e-01]])
</pre></div>
</div>
</div>
</div>
<p>The automatic decomposition returned by the svd function looks quite different than what we got when we manually decomposed our data into “data” and “operations”. That is, vt is a bunch of seemingly arbitrary numbers instead of the rather simple:</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span>&#160;&#160; <span class="pre">0</span>&#160;&#160; <span class="pre">0</span>&#160;&#160; <span class="pre">2</span> <span class="pre">0</span>&#160;&#160; <span class="pre">1</span>&#160;&#160; <span class="pre">0</span>&#160;&#160; <span class="pre">2</span> <span class="pre">0</span>&#160;&#160; <span class="pre">0</span>&#160;&#160; <span class="pre">1</span>&#160;&#160; <span class="pre">0</span></code></p>
<p>Similarly, if we look at the shape of <span class="math notranslate nohighlight">\(U\Sigma\)</span> and <span class="math notranslate nohighlight">\(V^T\)</span> we see that they are bigger than in our manual decomposition. Specifically <span class="math notranslate nohighlight">\(U\Sigma\)</span> still has 4 columns, meaning that each observation is 4 dimensional. Furthermore, rather than our transformation operation <span class="math notranslate nohighlight">\(V^T\)</span> being 3x4, it’s 4x4 rows tall, meaning that it maps 4 dimensional inputs back to 4 dimensions.</p>
<p>This seems problematic, because our goal of using SVD was to find a transformation operation that takes 3D inputs and maps them up to 4 dimensions.</p>
<p>Luckily, if we look carefully at <span class="math notranslate nohighlight">\(U\Sigma\)</span>, we see that the last attribute of each observation is very close to 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">*</span> <span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
         1.83452516e-15],
       [-1.39258714e+01, -5.61592446e+00,  1.59106852e+00,
        -3.36581235e-15],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-3.68444316e+01, -4.80005945e+00, -3.80095908e+00,
        -2.03741937e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-7.42135662e+00, -5.11810904e+00, -1.31469604e+00,
         7.80250388e-17],
       [-1.39588585e+01, -5.62314077e+00, -1.23715703e+00,
         5.55717762e-17],
       [-3.79895573e+01, -1.31360807e+00, -2.60712770e-01,
         3.01043718e-16],
       [-1.56692269e+01, -9.65347804e+00, -4.03555325e+00,
         3.52041495e-16],
       [-2.54468092e+01, -7.81311695e+00, -3.92620778e+00,
        -8.48509568e-17],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-4.08780385e+01, -1.86471027e+00, -2.34708823e+00,
         5.13492882e-17],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-2.82033419e+01, -8.33535389e+00,  5.30031897e+00,
         4.89486243e-17],
       [-6.40083890e+01,  7.06150790e+00,  1.43570386e+00,
         1.74060388e-16],
       [-4.32916052e+01, -1.02057499e-01, -9.09120615e-01,
         1.11263532e-16],
       [-1.39258714e+01, -5.61592446e+00,  1.59106852e+00,
         1.29145985e-16],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-1.84343928e+01, -4.99433025e+00, -4.79403711e-01,
         7.25592757e-18],
       [-1.77311945e+01, -1.07873203e+01, -4.71576755e+00,
        -5.67149843e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-3.31624238e+01, -4.83891361e+00, -3.13664801e+00,
         7.19721747e-17],
       [-4.40851318e+01,  4.87898862e-01,  5.12943775e-01,
         3.02603255e-16],
       [-3.18939828e+01, -3.11511500e+00, -1.03436931e+00,
         2.99484180e-16],
       [-4.08780385e+01, -1.86471027e+00, -2.34708823e+00,
         5.13492882e-17],
       [-2.25748215e+01, -7.26562290e+00, -3.25394509e+00,
         1.87126013e-16],
       [-2.29099271e+01, -4.36551973e+00,  2.78349606e-01,
        -3.75451682e-19],
       [-9.48332419e+00, -6.25195129e+00, -1.99491034e+00,
        -2.74769124e-17],
       [-7.09469707e+01,  9.44214673e+00, -6.10913535e-01,
        -2.57057627e-16],
       [-1.39588585e+01, -5.62314077e+00, -1.23715703e+00,
         5.55717762e-17],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-1.77311945e+01, -1.07873203e+01, -4.71576755e+00,
        -5.67149843e-16],
       [-2.74019549e+01, -3.74031736e+00, -3.78009854e-01,
        -1.65127367e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-6.23718552e+01,  5.89241965e+00,  2.83391341e+00,
        -1.81938882e-17],
       [-2.94144418e+01, -4.86333514e+00,  3.18411417e+00,
         3.46804968e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-5.71027944e+01,  4.67365277e+00,  6.54095701e-01,
         1.76237992e-16],
       [-1.47523850e+01, -5.03318441e+00,  1.84907363e-01,
         1.84935901e-16],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-2.54468092e+01, -7.81311695e+00, -3.92620778e+00,
        -8.48509568e-17],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-1.56692269e+01, -9.65347804e+00, -4.03555325e+00,
         3.52041495e-16],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-2.20834134e+01, -4.94825977e+00,  1.68451077e+00,
         2.91846763e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-3.79730637e+01, -1.30999991e+00,  1.15340001e+00,
        -1.06495470e-16],
       [-1.97931620e+01, -1.19211625e+01, -5.39598185e+00,
         1.11621311e-16],
       [-2.57984083e+01, -4.91662193e+00, -1.80802586e+00,
         2.97924643e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-5.62762807e+01,  4.09091272e+00,  2.06025686e+00,
         1.42984452e-16],
       [-1.97931620e+01, -1.19211625e+01, -5.39598185e+00,
         1.11621311e-16],
       [-2.53478478e+01, -7.79146801e+00,  4.55846888e+00,
         1.95178398e-16],
       [-2.94144418e+01, -4.86333514e+00,  3.18411417e+00,
         3.46804968e-16],
       [-3.79895573e+01, -1.31360807e+00, -2.60712770e-01,
         3.01043718e-16],
       [-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
        -7.51795410e-17],
       [-2.83187968e+01, -8.36061099e+00, -4.59847046e+00,
         2.64707301e-16],
       [-3.67454702e+01, -4.77841051e+00,  4.68371758e+00,
         4.68711369e-17],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-9.43384352e+00, -6.24112682e+00,  2.24742798e+00,
         1.12537765e-16],
       [-1.47523850e+01, -5.03318441e+00,  1.84907363e-01,
         1.84935901e-16],
       [-2.82033419e+01, -8.33535389e+00,  5.30031897e+00,
         4.89486243e-17],
       [-3.18939828e+01, -3.11511500e+00, -1.03436931e+00,
         2.99484180e-16],
       [-1.68308462e+01, -6.17063481e+00, -1.90941971e+00,
        -1.42390326e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-5.01807063e+01,  2.28940579e+00,  1.28660032e+00,
         3.04162792e-16],
       [-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
        -7.51795410e-17],
       [-2.24923537e+01, -7.24758212e+00,  3.81661879e+00,
         3.41408172e-16],
       [-3.18609957e+01, -3.10789868e+00,  1.79385624e+00,
        -1.45045689e-16],
       [-3.29742148e+00, -2.85042454e+00,  4.57325598e-02,
         1.11175616e-17],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-3.67454702e+01, -4.77841051e+00,  4.68371758e+00,
         4.68711369e-17],
       [-2.53478478e+01, -7.79146801e+00,  4.55846888e+00,
         1.95178398e-16],
       [-8.21488316e+00, -4.52815268e+00,  1.07368347e-01,
         1.47608402e-17],
       [-3.31624238e+01, -4.83891361e+00, -3.13664801e+00,
         7.19721747e-17],
       [-1.76157396e+01, -1.07620632e+01,  5.18302188e+00,
         1.93518744e-16],
       [-1.15452918e+01, -7.38579354e+00, -2.67512465e+00,
        -2.95716741e-16],
       [-4.32586181e+01, -9.48411854e-02,  1.91910494e+00,
        -2.63936669e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-7.42135662e+00, -5.11810904e+00, -1.31469604e+00,
         7.80250388e-17],
       [-7.09469707e+01,  9.44214673e+00, -6.10913535e-01,
        -2.57057627e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-2.73854614e+01, -3.73670921e+00,  1.03610292e+00,
        -1.54079509e-16],
       [-2.73854614e+01, -3.73670921e+00,  1.03610292e+00,
        -1.54079509e-16],
       [-1.14793175e+01, -7.37136091e+00,  2.98132646e+00,
        -2.99548674e-17],
       [-4.40851318e+01,  4.87898862e-01,  5.12943775e-01,
         3.02603255e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-6.40248825e+01,  7.05789975e+00,  2.15910829e-02,
         3.36050508e-17],
       [-9.43384352e+00, -6.24112682e+00,  2.24742798e+00,
         1.12537765e-16],
       [-1.35247915e+01, -8.50159500e+00,  3.71522493e+00,
        -1.72447500e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16]])
</pre></div>
</div>
</div>
</div>
<p>Thus, it makes sense that we remove the last column of <span class="math notranslate nohighlight">\(U \Sigma\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">u</span> <span class="o">*</span> <span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.63092679e+01,  4.08369641e+00, -7.67968689e-01],
       [-1.39258714e+01, -5.61592446e+00,  1.59106852e+00],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00],
       [-3.68444316e+01, -4.80005945e+00, -3.80095908e+00],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01],
       [-7.42135662e+00, -5.11810904e+00, -1.31469604e+00],
       [-1.39588585e+01, -5.62314077e+00, -1.23715703e+00],
       [-3.79895573e+01, -1.31360807e+00, -2.60712770e-01],
       [-1.56692269e+01, -9.65347804e+00, -4.03555325e+00],
       [-2.54468092e+01, -7.81311695e+00, -3.92620778e+00],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00],
       [-4.08780385e+01, -1.86471027e+00, -2.34708823e+00],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01],
       [-2.82033419e+01, -8.33535389e+00,  5.30031897e+00],
       [-6.40083890e+01,  7.06150790e+00,  1.43570386e+00],
       [-4.32916052e+01, -1.02057499e-01, -9.09120615e-01],
       [-1.39258714e+01, -5.61592446e+00,  1.59106852e+00],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00],
       [-1.84343928e+01, -4.99433025e+00, -4.79403711e-01],
       [-1.77311945e+01, -1.07873203e+01, -4.71576755e+00],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00],
       [-3.31624238e+01, -4.83891361e+00, -3.13664801e+00],
       [-4.40851318e+01,  4.87898862e-01,  5.12943775e-01],
       [-3.18939828e+01, -3.11511500e+00, -1.03436931e+00],
       [-4.08780385e+01, -1.86471027e+00, -2.34708823e+00],
       [-2.25748215e+01, -7.26562290e+00, -3.25394509e+00],
       [-2.29099271e+01, -4.36551973e+00,  2.78349606e-01],
       [-9.48332419e+00, -6.25195129e+00, -1.99491034e+00],
       [-7.09469707e+01,  9.44214673e+00, -6.10913535e-01],
       [-1.39588585e+01, -5.62314077e+00, -1.23715703e+00],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01],
       [-1.77311945e+01, -1.07873203e+01, -4.71576755e+00],
       [-2.74019549e+01, -3.74031736e+00, -3.78009854e-01],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00],
       [-6.23718552e+01,  5.89241965e+00,  2.83391341e+00],
       [-2.94144418e+01, -4.86333514e+00,  3.18411417e+00],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00],
       [-5.71027944e+01,  4.67365277e+00,  6.54095701e-01],
       [-1.47523850e+01, -5.03318441e+00,  1.84907363e-01],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00],
       [-2.54468092e+01, -7.81311695e+00, -3.92620778e+00],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00],
       [-1.56692269e+01, -9.65347804e+00, -4.03555325e+00],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01],
       [-2.20834134e+01, -4.94825977e+00,  1.68451077e+00],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00],
       [-3.79730637e+01, -1.30999991e+00,  1.15340001e+00],
       [-1.97931620e+01, -1.19211625e+01, -5.39598185e+00],
       [-2.57984083e+01, -4.91662193e+00, -1.80802586e+00],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00],
       [-5.62762807e+01,  4.09091272e+00,  2.06025686e+00],
       [-1.97931620e+01, -1.19211625e+01, -5.39598185e+00],
       [-2.53478478e+01, -7.79146801e+00,  4.55846888e+00],
       [-2.94144418e+01, -4.86333514e+00,  3.18411417e+00],
       [-3.79895573e+01, -1.31360807e+00, -2.60712770e-01],
       [-5.63092679e+01,  4.08369641e+00, -7.67968689e-01],
       [-2.83187968e+01, -8.36061099e+00, -4.59847046e+00],
       [-3.67454702e+01, -4.77841051e+00,  4.68371758e+00],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00],
       [-9.43384352e+00, -6.24112682e+00,  2.24742798e+00],
       [-1.47523850e+01, -5.03318441e+00,  1.84907363e-01],
       [-2.82033419e+01, -8.33535389e+00,  5.30031897e+00],
       [-3.18939828e+01, -3.11511500e+00, -1.03436931e+00],
       [-1.68308462e+01, -6.17063481e+00, -1.90941971e+00],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00],
       [-5.01807063e+01,  2.28940579e+00,  1.28660032e+00],
       [-5.63092679e+01,  4.08369641e+00, -7.67968689e-01],
       [-2.24923537e+01, -7.24758212e+00,  3.81661879e+00],
       [-3.18609957e+01, -3.10789868e+00,  1.79385624e+00],
       [-3.29742148e+00, -2.85042454e+00,  4.57325598e-02],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01],
       [-3.67454702e+01, -4.77841051e+00,  4.68371758e+00],
       [-2.53478478e+01, -7.79146801e+00,  4.55846888e+00],
       [-8.21488316e+00, -4.52815268e+00,  1.07368347e-01],
       [-3.31624238e+01, -4.83891361e+00, -3.13664801e+00],
       [-1.76157396e+01, -1.07620632e+01,  5.18302188e+00],
       [-1.15452918e+01, -7.38579354e+00, -2.67512465e+00],
       [-4.32586181e+01, -9.48411854e-02,  1.91910494e+00],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00],
       [-7.42135662e+00, -5.11810904e+00, -1.31469604e+00],
       [-7.09469707e+01,  9.44214673e+00, -6.10913535e-01],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01],
       [-2.73854614e+01, -3.73670921e+00,  1.03610292e+00],
       [-2.73854614e+01, -3.73670921e+00,  1.03610292e+00],
       [-1.14793175e+01, -7.37136091e+00,  2.98132646e+00],
       [-4.40851318e+01,  4.87898862e-01,  5.12943775e-01],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00],
       [-6.40248825e+01,  7.05789975e+00,  2.15910829e-02],
       [-9.43384352e+00, -6.24112682e+00,  2.24742798e+00],
       [-1.35247915e+01, -8.50159500e+00,  3.71522493e+00],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00]])
</pre></div>
</div>
</div>
</div>
<p>Similarly, because the observations are now 3D, we should remove the last row of <span class="math notranslate nohighlight">\(V^T\)</span>, since we want to use <span class="math notranslate nohighlight">\(V^T\)</span> to map our now 3D data into 4D (rather than expecting 4D input data).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vt</span> <span class="o">=</span> <span class="n">vt</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<p>After removing the redundant portions of <span class="math notranslate nohighlight">\(U\Sigma\)</span> and <span class="math notranslate nohighlight">\(V^T\)</span>, we can verify that multiplying them together again yields our original array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">*</span> <span class="n">s</span> <span class="o">@</span> <span class="n">vt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8.,  6., 48., 28.],
       [ 2.,  4.,  8., 12.],
       [ 1.,  3.,  3.,  8.],
       [ 9.,  3., 27., 24.],
       [ 9.,  8., 72., 34.],
       [ 3.,  1.,  3.,  8.],
       [ 4.,  2.,  8., 12.],
       [ 6.,  5., 30., 22.],
       [ 7.,  1.,  7., 16.],
       [ 8.,  2., 16., 20.],
       [ 5.,  5., 25., 20.],
       [ 9.,  5., 45., 28.],
       [ 8.,  4., 32., 24.],
       [ 1.,  2.,  2.,  6.],
       [ 2.,  9., 18., 22.],
       [ 7.,  8., 56., 30.],
       [ 7.,  5., 35., 24.],
       [ 2.,  4.,  8., 12.],
       [ 2.,  5., 10., 14.],
       [ 4.,  3., 12., 14.],
       [ 8.,  1.,  8., 18.],
       [ 8.,  5., 40., 26.],
       [ 9.,  8., 72., 34.],
       [ 7.,  3., 21., 20.],
       [ 8.,  3., 24., 22.],
       [ 6.,  6., 36., 24.],
       [ 6.,  4., 24., 20.],
       [ 8.,  4., 32., 24.],
       [ 7.,  2., 14., 18.],
       [ 4.,  4., 16., 16.],
       [ 4.,  1.,  4., 10.],
       [ 9.,  7., 63., 32.],
       [ 4.,  2.,  8., 12.],
       [ 1.,  2.,  2.,  6.],
       [ 8.,  1.,  8., 18.],
       [ 5.,  4., 20., 18.],
       [ 9.,  5., 45., 28.],
       [ 6.,  9., 54., 30.],
       [ 3.,  7., 21., 20.],
       [ 7.,  3., 21., 20.],
       [ 7.,  7., 49., 28.],
       [ 3.,  3.,  9., 12.],
       [ 5.,  5., 25., 20.],
       [ 7.,  3., 21., 20.],
       [ 8.,  2., 16., 20.],
       [ 2.,  6., 12., 16.],
       [ 7.,  1.,  7., 16.],
       [ 1.,  2.,  2.,  6.],
       [ 3.,  5., 15., 16.],
       [ 2.,  6., 12., 16.],
       [ 5.,  6., 30., 22.],
       [ 9.,  1.,  9., 20.],
       [ 6.,  3., 18., 18.],
       [ 2.,  6., 12., 16.],
       [ 6.,  8., 48., 28.],
       [ 9.,  1.,  9., 20.],
       [ 2.,  8., 16., 20.],
       [ 3.,  7., 21., 20.],
       [ 6.,  5., 30., 22.],
       [ 8.,  6., 48., 28.],
       [ 9.,  2., 18., 22.],
       [ 3.,  9., 27., 24.],
       [ 2.,  5., 10., 14.],
       [ 1.,  4.,  4., 10.],
       [ 3.,  3.,  9., 12.],
       [ 2.,  9., 18., 22.],
       [ 6.,  4., 24., 20.],
       [ 5.,  2., 10., 14.],
       [ 2.,  6., 12., 16.],
       [ 2.,  5., 10., 14.],
       [ 1.,  3.,  3.,  8.],
       [ 1.,  3.,  3.,  8.],
       [ 6.,  7., 42., 26.],
       [ 8.,  6., 48., 28.],
       [ 2.,  7., 14., 18.],
       [ 4.,  6., 24., 20.],
       [ 1.,  1.,  1.,  4.],
       [ 9.,  8., 72., 34.],
       [ 5.,  5., 25., 20.],
       [ 3.,  9., 27., 24.],
       [ 2.,  8., 16., 20.],
       [ 2.,  2.,  4.,  8.],
       [ 8.,  3., 24., 22.],
       [ 1.,  8.,  8., 18.],
       [ 5.,  1.,  5., 12.],
       [ 5.,  7., 35., 24.],
       [ 9.,  5., 45., 28.],
       [ 3.,  1.,  3.,  8.],
       [ 9.,  7., 63., 32.],
       [ 8.,  5., 40., 26.],
       [ 9.,  8., 72., 34.],
       [ 4.,  5., 20., 18.],
       [ 4.,  5., 20., 18.],
       [ 1.,  5.,  5., 12.],
       [ 6.,  6., 36., 24.],
       [ 8.,  5., 40., 26.],
       [ 8.,  7., 56., 30.],
       [ 1.,  4.,  4., 10.],
       [ 1.,  6.,  6., 14.],
       [ 2.,  6., 12., 16.]])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Singular Value Decomposition Experiment<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The reasons that <span class="math notranslate nohighlight">\(U \Sigma\)</span> and <span class="math notranslate nohighlight">\(V^T\)</span> look so different than the results of our manual decomposition are a consequence of how singular value decomposition. Specifically, given X, SVD computers <span class="math notranslate nohighlight">\(U\)</span>, <span class="math notranslate nohighlight">\(\Sigma\)</span>, and <span class="math notranslate nohighlight">\(V\)</span> such that:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\Sigma\)</span> is a diagonal matrix containing the singular values of X.</p></li>
<li><p><span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are matrices whose columns form an orthonormal set.</p></li>
<li><p><span class="math notranslate nohighlight">\(X = U \Sigma V^T\)</span></p></li>
</ol>
<p>That is, there are an infinite number of matrices such that <span class="math notranslate nohighlight">\(X = AB\)</span>. In our example above, we created A and B through manual calculation and insight (recognizing that perimeter was 2<em>w + 2</em>h). SVD computes them automatically, and the results have the specific properties enumerated above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">rectangle</span><span class="p">,</span> <span class="n">full_matrices</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-singular-values-matrix-sigma">
<h3>The Singular Values Matrix <span class="math notranslate nohighlight">\(\Sigma\)</span><a class="headerlink" href="#the-singular-values-matrix-sigma" title="Permalink to this headline">¶</a></h3>
<p>The middle result returned by the SVD process is a diagonal matrix consisting of the singular values. We won’t say a lot about what they mean today, but we will note that if the matrix is of rank r, then the first r singular values will be non-zero, and the rest will be zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3.62932568e+02, 6.29904732e+01, 2.56544651e+01, 4.29718368e-15])
</pre></div>
</div>
</div>
</div>
<p>Python returns the singular values in a slightly funny format (as a list). To get them into the correct form, we can use <code class="docutils literal notranslate"><span class="pre">diag(s)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[3.62932568e+02, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 6.29904732e+01, 0.00000000e+00, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 2.56544651e+01, 0.00000000e+00],
       [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 4.29718368e-15]])
</pre></div>
</div>
</div>
</div>
<p>If we do this, then we can compute the original matrix using only the matrix multiplication operator. That is, rather than writing <code class="docutils literal notranslate"><span class="pre">u</span> <span class="pre">*</span> <span class="pre">s</span> <span class="pre">&#64;</span> <span class="pre">vt</span></code>, we can do <code class="docutils literal notranslate"><span class="pre">u</span> <span class="pre">&#64;</span> <span class="pre">np.diag(s)</span> <span class="pre">&#64;</span> <span class="pre">vt</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">u</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">vt</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8.,  6., 48., 28.],
       [ 2.,  4.,  8., 12.],
       [ 1.,  3.,  3.,  8.],
       [ 9.,  3., 27., 24.],
       [ 9.,  8., 72., 34.]])
</pre></div>
</div>
</div>
</div>
<p>The fact that the last singular value is zero is why we were able to remove the last dimension of <span class="math notranslate nohighlight">\(U\)</span> and the last operation in <span class="math notranslate nohighlight">\(V^T\)</span>. That is, since the last column of <span class="math notranslate nohighlight">\(U \Sigma\)</span> is always zero, we can just remove it completely.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">u</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
         1.83452516e-15],
       [-1.39258714e+01, -5.61592446e+00,  1.59106852e+00,
        -3.36581235e-15],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-3.68444316e+01, -4.80005945e+00, -3.80095908e+00,
        -2.03741937e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-7.42135662e+00, -5.11810904e+00, -1.31469604e+00,
         7.80250388e-17],
       [-1.39588585e+01, -5.62314077e+00, -1.23715703e+00,
         5.55717762e-17],
       [-3.79895573e+01, -1.31360807e+00, -2.60712770e-01,
         3.01043718e-16],
       [-1.56692269e+01, -9.65347804e+00, -4.03555325e+00,
         3.52041495e-16],
       [-2.54468092e+01, -7.81311695e+00, -3.92620778e+00,
        -8.48509568e-17],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-4.08780385e+01, -1.86471027e+00, -2.34708823e+00,
         5.13492882e-17],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-2.82033419e+01, -8.33535389e+00,  5.30031897e+00,
         4.89486243e-17],
       [-6.40083890e+01,  7.06150790e+00,  1.43570386e+00,
         1.74060388e-16],
       [-4.32916052e+01, -1.02057499e-01, -9.09120615e-01,
         1.11263532e-16],
       [-1.39258714e+01, -5.61592446e+00,  1.59106852e+00,
         1.29145985e-16],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-1.84343928e+01, -4.99433025e+00, -4.79403711e-01,
         7.25592757e-18],
       [-1.77311945e+01, -1.07873203e+01, -4.71576755e+00,
        -5.67149843e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-3.31624238e+01, -4.83891361e+00, -3.13664801e+00,
         7.19721747e-17],
       [-4.40851318e+01,  4.87898862e-01,  5.12943775e-01,
         3.02603255e-16],
       [-3.18939828e+01, -3.11511500e+00, -1.03436931e+00,
         2.99484180e-16],
       [-4.08780385e+01, -1.86471027e+00, -2.34708823e+00,
         5.13492882e-17],
       [-2.25748215e+01, -7.26562290e+00, -3.25394509e+00,
         1.87126013e-16],
       [-2.29099271e+01, -4.36551973e+00,  2.78349606e-01,
        -3.75451682e-19],
       [-9.48332419e+00, -6.25195129e+00, -1.99491034e+00,
        -2.74769124e-17],
       [-7.09469707e+01,  9.44214673e+00, -6.10913535e-01,
        -2.57057627e-16],
       [-1.39588585e+01, -5.62314077e+00, -1.23715703e+00,
         5.55717762e-17],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-1.77311945e+01, -1.07873203e+01, -4.71576755e+00,
        -5.67149843e-16],
       [-2.74019549e+01, -3.74031736e+00, -3.78009854e-01,
        -1.65127367e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-6.23718552e+01,  5.89241965e+00,  2.83391341e+00,
        -1.81938882e-17],
       [-2.94144418e+01, -4.86333514e+00,  3.18411417e+00,
         3.46804968e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-5.71027944e+01,  4.67365277e+00,  6.54095701e-01,
         1.76237992e-16],
       [-1.47523850e+01, -5.03318441e+00,  1.84907363e-01,
         1.84935901e-16],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-2.94804161e+01, -4.87776777e+00, -2.47233693e+00,
         2.22105316e-17],
       [-2.54468092e+01, -7.81311695e+00, -3.92620778e+00,
        -8.48509568e-17],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-1.56692269e+01, -9.65347804e+00, -4.03555325e+00,
         3.52041495e-16],
       [-5.34289549e+00, -3.98065864e+00,  7.79631035e-01,
         7.20472757e-17],
       [-2.20834134e+01, -4.94825977e+00,  1.68451077e+00,
         2.91846763e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-3.79730637e+01, -1.30999991e+00,  1.15340001e+00,
        -1.06495470e-16],
       [-1.97931620e+01, -1.19211625e+01, -5.39598185e+00,
         1.11621311e-16],
       [-2.57984083e+01, -4.91662193e+00, -1.80802586e+00,
         2.97924643e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-5.62762807e+01,  4.09091272e+00,  2.06025686e+00,
         1.42984452e-16],
       [-1.97931620e+01, -1.19211625e+01, -5.39598185e+00,
         1.11621311e-16],
       [-2.53478478e+01, -7.79146801e+00,  4.55846888e+00,
         1.95178398e-16],
       [-2.94144418e+01, -4.86333514e+00,  3.18411417e+00,
         3.46804968e-16],
       [-3.79895573e+01, -1.31360807e+00, -2.60712770e-01,
         3.01043718e-16],
       [-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
        -7.51795410e-17],
       [-2.83187968e+01, -8.36061099e+00, -4.59847046e+00,
         2.64707301e-16],
       [-3.67454702e+01, -4.77841051e+00,  4.68371758e+00,
         4.68711369e-17],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-9.43384352e+00, -6.24112682e+00,  2.24742798e+00,
         1.12537765e-16],
       [-1.47523850e+01, -5.03318441e+00,  1.84907363e-01,
         1.84935901e-16],
       [-2.82033419e+01, -8.33535389e+00,  5.30031897e+00,
         4.89486243e-17],
       [-3.18939828e+01, -3.11511500e+00, -1.03436931e+00,
         2.99484180e-16],
       [-1.68308462e+01, -6.17063481e+00, -1.90941971e+00,
        -1.42390326e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16],
       [-1.67813655e+01, -6.15981034e+00,  2.33291861e+00,
        -1.70837887e-17],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-7.38836950e+00, -5.11089273e+00,  1.51352951e+00,
        -7.04453569e-17],
       [-5.01807063e+01,  2.28940579e+00,  1.28660032e+00,
         3.04162792e-16],
       [-5.63092679e+01,  4.08369641e+00, -7.67968689e-01,
        -7.51795410e-17],
       [-2.24923537e+01, -7.24758212e+00,  3.81661879e+00,
         3.41408172e-16],
       [-3.18609957e+01, -3.10789868e+00,  1.79385624e+00,
        -1.45045689e-16],
       [-3.29742148e+00, -2.85042454e+00,  4.57325598e-02,
         1.11175616e-17],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-3.26875093e+01, -2.52515864e+00,  3.87695076e-01,
        -1.26500289e-16],
       [-3.67454702e+01, -4.77841051e+00,  4.68371758e+00,
         4.68711369e-17],
       [-2.53478478e+01, -7.79146801e+00,  4.55846888e+00,
         1.95178398e-16],
       [-8.21488316e+00, -4.52815268e+00,  1.07368347e-01,
         1.47608402e-17],
       [-3.31624238e+01, -4.83891361e+00, -3.13664801e+00,
         7.19721747e-17],
       [-1.76157396e+01, -1.07620632e+01,  5.18302188e+00,
         1.93518744e-16],
       [-1.15452918e+01, -7.38579354e+00, -2.67512465e+00,
        -2.95716741e-16],
       [-4.32586181e+01, -9.48411854e-02,  1.91910494e+00,
        -2.63936669e-16],
       [-5.38957011e+01,  2.32104364e+00, -2.20593631e+00,
        -2.37753852e-16],
       [-7.42135662e+00, -5.11810904e+00, -1.31469604e+00,
         7.80250388e-17],
       [-7.09469707e+01,  9.44214673e+00, -6.10913535e-01,
        -2.57057627e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-7.94726055e+01,  1.30026983e+01,  1.86597851e-01,
        -2.66709514e-16],
       [-2.73854614e+01, -3.73670921e+00,  1.03610292e+00,
        -1.54079509e-16],
       [-2.73854614e+01, -3.73670921e+00,  1.03610292e+00,
        -1.54079509e-16],
       [-1.14793175e+01, -7.37136091e+00,  2.98132646e+00,
        -2.99548674e-17],
       [-4.40851318e+01,  4.87898862e-01,  5.12943775e-01,
         3.02603255e-16],
       [-4.85936532e+01,  1.10949307e+00, -1.55752846e+00,
        -1.09949265e-16],
       [-6.40248825e+01,  7.05789975e+00,  2.15910829e-02,
         3.36050508e-17],
       [-9.43384352e+00, -6.24112682e+00,  2.24742798e+00,
         1.12537765e-16],
       [-1.35247915e+01, -8.50159500e+00,  3.71522493e+00,
        -1.72447500e-16],
       [-1.96368596e+01, -6.70369623e+00,  3.07476870e+00,
        -1.63313563e-16]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">vt</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8.,  6., 48., 28.],
       [ 2.,  4.,  8., 12.],
       [ 1.,  3.,  3.,  8.],
       [ 9.,  3., 27., 24.],
       [ 9.,  8., 72., 34.]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="u-and-v-t">
<h3><span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V^T\)</span><a class="headerlink" href="#u-and-v-t" title="Permalink to this headline">¶</a></h3>
<p>Let’s try verifying that <span class="math notranslate nohighlight">\(U\)</span> is orthonormal. If so, any column dot producted with itself should be 1, and any columns dot producted with any other should be zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0000000000000009
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.000000000000001
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> dot producted with itself is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>row 0 dot producted with itself is 1.0000000000000009
row 1 dot producted with itself is 1.000000000000001
row 2 dot producted with itself is 1.0
row 3 dot producted with itself is 1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> dot producted with </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>row 0 dot producted with 1 is -1.3877787807814457e-17
row 0 dot producted with 2 is -1.5959455978986625e-16
row 0 dot producted with 3 is 1.1102230246251565e-16
row 1 dot producted with 2 is -1.5265566588595902e-16
row 1 dot producted with 3 is 3.469446951953614e-17
row 2 dot producted with 3 is -2.7755575615628914e-17
</pre></div>
</div>
</div>
</div>
<p>Let’s now look at <span class="math notranslate nohighlight">\(V\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> of V dot producted with itself is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">v</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>row 0 of V dot producted with itself is 0.9999999999999999
row 1 of V dot producted with itself is 0.9999999999999991
row 2 of V dot producted with itself is 0.9999999999999994
row 3 of V dot producted with itself is 0.9999999999999998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> of V dot producted with </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">v</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>row 0 of V dot producted with 1 is -9.71445146547012e-17
row 0 of V dot producted with 2 is -2.42861286636753e-17
row 0 of V dot producted with 3 is 8.326672684688674e-17
row 1 of V dot producted with 2 is -2.931682674400804e-16
row 1 of V dot producted with 3 is 1.6653345369377348e-16
row 2 of V dot producted with 3 is -1.0928757898653885e-16
</pre></div>
</div>
</div>
</div>
<p>We can also see that the transpose of u (and v) is also the inverse of u (and v).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">u</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.00000000e+00, -2.08166817e-17, -1.31838984e-16,
         1.11022302e-16],
       [-2.08166817e-17,  1.00000000e+00, -9.71445147e-17,
         4.16333634e-17],
       [-1.31838984e-16, -9.71445147e-17,  1.00000000e+00,
        -2.08166817e-17],
       [ 1.11022302e-16,  4.16333634e-17, -2.08166817e-17,
         1.00000000e+00]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.00000000e+00, -1.11022302e-16, -2.77555756e-17,
         6.93889390e-17],
       [-1.11022302e-16,  1.00000000e+00, -3.05311332e-16,
         1.11022302e-16],
       [-2.77555756e-17, -3.05311332e-16,  1.00000000e+00,
        -1.11022302e-16],
       [ 6.93889390e-17,  1.11022302e-16, -1.11022302e-16,
         1.00000000e+00]])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="low-rank-approximations-of-rectangle-data">
<h2>Low Rank Approximations of Rectangle Data<a class="headerlink" href="#low-rank-approximations-of-rectangle-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rectangle</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppose we our area and perimeter measurements are slightly noisy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rectangle_noisy</span> <span class="o">=</span> <span class="n">rectangle</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">rectangle_noisy</span><span class="p">[</span><span class="s2">&quot;perimeter&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rectangle_noisy</span><span class="p">[</span><span class="s2">&quot;perimeter&quot;</span><span class="p">]))</span>
<span class="n">rectangle_noisy</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rectangle_noisy</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]))</span>
<span class="n">rectangle_noisy</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>6</td>
      <td>48.015242</td>
      <td>27.993663</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>4</td>
      <td>8.018244</td>
      <td>11.984777</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>2.997070</td>
      <td>7.999929</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>3</td>
      <td>26.973836</td>
      <td>23.980785</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>8</td>
      <td>71.983917</td>
      <td>33.992081</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">rectangle_noisy</span><span class="p">,</span> <span class="n">full_matrices</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Even on this noisy data, we can recover the exact measurements by multiplying <span class="math notranslate nohighlight">\(U \Sigma V^T\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.46441547e-01, -1.29950106e-01, -8.10028942e-01,
        -5.52739502e-01],
       [-1.92783352e-01, -1.89088276e-01,  5.86336486e-01,
        -7.63734069e-01],
       [-7.04943496e-01,  7.09169081e-01,  7.91449505e-03,
         8.44059275e-03],
       [-6.66666424e-01, -6.66661690e-01,  1.00595982e-05,
         3.33343773e-01]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">u</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">vt</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.0</td>
      <td>6.0</td>
      <td>48.015242</td>
      <td>27.993663</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>4.0</td>
      <td>8.018244</td>
      <td>11.984777</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.997070</td>
      <td>7.999929</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.0</td>
      <td>3.0</td>
      <td>26.973836</td>
      <td>23.980785</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9.0</td>
      <td>8.0</td>
      <td>71.983917</td>
      <td>33.992081</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s take a look at the singular values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3.62914977e+02, 6.29877681e+01, 2.56545678e+01, 3.08796705e-02])
</pre></div>
</div>
</div>
</div>
<p>Despite not being zero, we can nevertheless again eliminate the last column (dimension) of <span class="math notranslate nohighlight">\(U\)</span>, last singular value from <span class="math notranslate nohighlight">\(\Sigma\)</span> and last row (operation) from <span class="math notranslate nohighlight">\(V^T\)</span>. We see that we get back reasonable answers, though they’re a little off.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">u</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">vt</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">colnames</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.999130</td>
      <td>5.999130</td>
      <td>48.015242</td>
      <td>27.994098</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.996768</td>
      <td>3.996768</td>
      <td>8.018244</td>
      <td>11.986393</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.000070</td>
      <td>3.000070</td>
      <td>2.997070</td>
      <td>7.999894</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.996089</td>
      <td>2.996089</td>
      <td>26.973836</td>
      <td>23.982740</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.998987</td>
      <td>7.998987</td>
      <td>71.983917</td>
      <td>33.992587</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This is what is known as a “low rank approximation” of the data. Specifically, this is a rank 3 approximation since we’re using 3 of the available 4 dimensions. Since the noise was small, this rank 3 approximation is good.</p>
<p>As a warmup to the rest of lecture, let’s see what the rank 2 approximation looks like.</p>
<p>Note: In the code below, I’ve specified which rows/columns that I do want rather than the ones I don’t want. That is, instead of writing <code class="docutils literal notranslate"><span class="pre">u[:,</span> <span class="pre">:-2]</span></code>, I’ve written <code class="docutils literal notranslate"><span class="pre">u[:,</span> <span class="pre">0:2]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">@</span> <span class="n">vt</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]),</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">colnames</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.457568</td>
      <td>6.543938</td>
      <td>48.021322</td>
      <td>28.000582</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.118621</td>
      <td>2.868190</td>
      <td>8.005649</td>
      <td>11.972960</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.067219</td>
      <td>1.926524</td>
      <td>2.985089</td>
      <td>7.987117</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.316537</td>
      <td>5.691703</td>
      <td>27.003920</td>
      <td>24.014824</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9.129748</td>
      <td>7.867443</td>
      <td>71.982449</td>
      <td>33.991021</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This code is getting a little hard to read, so let’s write a function that computes the rank k approximation of a given DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_rank_k_approximation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">full_matrices</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="p">])</span> <span class="o">@</span> <span class="n">vt</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="p">,</span> <span class="p">:],</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">compute_rank_k_approximation</span><span class="p">(</span><span class="n">rectangle_noisy</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.457568</td>
      <td>6.543938</td>
      <td>48.021322</td>
      <td>28.000582</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.118621</td>
      <td>2.868190</td>
      <td>8.005649</td>
      <td>11.972960</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.067219</td>
      <td>1.926524</td>
      <td>2.985089</td>
      <td>7.987117</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.316537</td>
      <td>5.691703</td>
      <td>27.003920</td>
      <td>24.014824</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9.129748</td>
      <td>7.867443</td>
      <td>71.982449</td>
      <td>33.991021</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can even look at the rank 1 approximation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compute_rank_k_approximation</span><span class="p">(</span><span class="n">rectangle_noisy</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.247320</td>
      <td>7.318552</td>
      <td>45.619349</td>
      <td>31.129278</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.040246</td>
      <td>1.810485</td>
      <td>11.285447</td>
      <td>7.700851</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.081600</td>
      <td>0.959796</td>
      <td>5.982778</td>
      <td>4.082469</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.390885</td>
      <td>4.783793</td>
      <td>29.819222</td>
      <td>20.347745</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11.635571</td>
      <td>10.325237</td>
      <td>64.361171</td>
      <td>43.918136</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In effect, what the SVD process has done is figured out a way to rebuild an approximation of our entire 4D matrix using only 1 column of data. This might seem somewhat shocking.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">vt</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]),</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">colnames</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.247320</td>
      <td>7.318552</td>
      <td>45.619349</td>
      <td>31.129278</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.040246</td>
      <td>1.810485</td>
      <td>11.285447</td>
      <td>7.700851</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.081600</td>
      <td>0.959796</td>
      <td>5.982778</td>
      <td>4.082469</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.390885</td>
      <td>4.783793</td>
      <td>29.819222</td>
      <td>20.347745</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11.635571</td>
      <td>10.325237</td>
      <td>64.361171</td>
      <td>43.918136</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">rectangle</span><span class="p">,</span> <span class="n">full_matrices</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">compute_rank_k_approximation</span><span class="p">(</span><span class="n">rectangle_noisy</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>width</th>
      <th>height</th>
      <th>area</th>
      <th>perimeter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.247320</td>
      <td>7.318552</td>
      <td>45.619349</td>
      <td>31.129278</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.040246</td>
      <td>1.810485</td>
      <td>11.285447</td>
      <td>7.700851</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.081600</td>
      <td>0.959796</td>
      <td>5.982778</td>
      <td>4.082469</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.390885</td>
      <td>4.783793</td>
      <td>29.819222</td>
      <td>20.347745</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11.635571</td>
      <td>10.325237</td>
      <td>64.361171</td>
      <td>43.918136</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ch/19"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sam Lau, Joey Gonzalez, and Deb Nolan<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            <p>
License: CC BY-NC-ND 4.0
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-113006011-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>